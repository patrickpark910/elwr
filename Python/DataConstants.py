# Molar masses
mm_T   = 3.016 # g/mol
mm_Li6 = 6.015 # g/mol
mm_Li7 = 7.016 # g/mol
mm_U235 = 235.044 # g/mol
mm_U238 = 238.051 # g/mol

# Physical constants
mu = 1.660539 # b-mol/cm**2-at
avo = 6.022e23 # at/mol

# Reactor settings
e_U = 0.035
e_Li = 0.9
m_UO2 = 4000 # kg
m_U = m_UO2*(e_U*mm_U235+(1-e_U)*mm_U238)/(32+(e_U*mm_U235+(1-e_U)*mm_U238)) # kg

MWdkgU_to_efpd = m_U / 100
MWdkgU_to_s    = MWdkgU_to_efpd*86400
efpd_to_yr     = 300 # efpd per year
refuel_d    =  180
SWU_per_kgU = 4.610 # SWU per kgU for feed = 0.711%, tails = 0.27% from Urenco calculator
# print(f"{MWdkgU_to_s:.12e}")
t_zr4   = 0.0573 # cm
t_ss304 = 0.0400 # cm

A_Zr_000 = {
    'Cladding'   : 'zr-4',
    'Batches'    : None,
    'Li6 initial': 0, # mg/kgU
    'Li6 final'  : 0, # mg/kgU
    'Li6 eff avg': 0, # mg/kgU
    'Li6 load' : 0, # g/cycle
    #         y3 = y1+((y2-y1)/(x2 - x1)) * (x3 - x1)
    'EOC burnup' : 15+((20-15)/(1.02928-1.07502))*(1.03-1.07502), # MWd/kgU
    'T produced' : 0, # g
    'Pu produced': 18.650803+((22.742755-18.650803)/(1.02928-1.07502))*(1.03-1.07502), # kg
    'Pu-239 frac': 74.6000052+((68.5875568-74.6000052)/(1.02928-1.07502))*(1.03-1.07502), # %
    }

A_Zr_091 = {
    'Cladding'   : 'zr-4',
    'Batches'    : None,
    'Li6 initial': 122.0,        # mg/kgU
    'Li6 final'  : 66.244771, # mg/kgU
    'Li6 eff avg': 91.36266, # mg/kgU
    'Li6 load'   : 322.129,  # g/cycle
    #         y3 = y1+((y2-y1)/(x2 - x1)) * (x3 - x1)
    'EOC burnup' : 10+((15-10)/(1.00116-1.03865))*(1.03-1.03865), # MWd/kgU
    'T produced' : 95.372129, # g
    'Pu produced': 15.6391716+((21.540244-15.6391716)/(1.00116-1.03865))*(1.03-1.03865), # kg
    'Pu-239 frac': 83.67578753+((77.52094173-83.67578753)/(1.00116-1.03865))*(1.03-1.03865), # %
    }

A_Zr_139 = {
    'Cladding'   : 'zr-4',
    'Batches'    : None,
    'Li6 initial': 161.0000,        # mg/kgU
    'Li6 final'  : 119.531647, # mg/kgU
    'Li6 eff avg': 139.254368, # mg/kgU
    'Li6 load'   : 490.987,  # g/cycle
    #         y3 = y1+((y2-y1)/(x2 - x1)) * (x3 - x1)
    'EOC burnup' : 5+((10-5)/(0.99708-1.03454))*(1.03-1.03454), # MWd/kgU
    'T produced' : 72.122728, # g
    'Pu produced': 8.86851543+((16.1440449-8.86851543)/(0.99708-1.03454))*(1.03-1.03454), # kg
    'Pu-239 frac': 91.0468055643897+((83.7349009107376-91.0468055643897)/(0.99708-1.03454))*(1.03-1.03454), # %
    }

A_Zr_141 = {
    'Cladding'   : 'zr-4',
    'Batches'    : None,
    'Li6 initial': 162.0000,        # mg/kgU
    'Li6 final'  : 121.363132, # mg/kgU
    'Li6 eff avg': 140.719933, # mg/kgU
    'Li6 load'   : 496.155,  # g/cycle
    #         y3 = y1+((y2-y1)/(x2 - x1)) * (x3 - x1)
    'EOC burnup' : 5+((10-5)/(0.99627-1.03338))*(1.03-1.03338), # MWd/kgU
    'T produced' : 66.175021, # g
    'Pu produced': 8.88124001+((16.1672673-8.88124001)/(0.99627-1.03338))*(1.03-1.03338), # kg
    'Pu-239 frac': 91.0447188781693+((83.7302912657354-91.0447188781693)/(0.99627-1.03338))*(1.03-1.03338), # %
    }

A_Zr_145 = {
    'Cladding'   : 'zr-4',
    'Batches'    : None,
    'Li6 initial': 165.0000,        # mg/kgU
    'Li6 final'  : 127.025786, # mg/kgU
    'Li6 eff avg': 145.197824, # mg/kgU
    'Li6 load'   : 511.943,  # g/cycle
    #         y3 = y1+((y2-y1)/(x2 - x1)) * (x3 - x1)
    'EOC burnup' : 1+((5-1)/(1.02941-1.05663))*(1.03-1.05663), # MWd/kgU
    'T produced' : 66.175021, # g
    'Pu produced': 1.821659452+((8.90556331-1.821659452)/(1.02941-1.05663))*(1.03-1.05663), # kg
    'Pu-239 frac': 98.0688239193609+((91.0487042509161-98.0688239193609)/(1.02941-1.05663))*(1.03-1.05663), # %
    }

A_Zr_147 = {
    'Cladding'   : 'zr-4',
    'Batches'    : None,
    'Li6 initial': 166.0,        # mg/kgU
    'Li6 final'  : 128.969860, # mg/kgU
    'Li6 eff avg': 146.717498, # mg/kgU
    'Li6 load' : 517.301,  # g/cycle
    #         y3 = y1+((y2-y1)/(x2 - x1)) * (x3 - x1)
    'EOC burnup' : 1+((5-1)/(1.02814-1.05525))*(1.03-1.05525), # MWd/kgU
    'T produced' : 64.561781, # g
    'Pu produced': 1.822303947+((8.90744442-1.822303947)/(1.02814-1.05525))*(1.03-1.05525), # kg
    'Pu-239 frac': 98.069260205013+((91.0508066914214-98.069260205013)/(1.02814-1.05525))*(1.03-1.05525), # %
    }

A_Zr_154 = {
    'Cladding'   : 'zr-4',
    'Batches'    : None,
    'Li6 initial': 171,        # mg/kgU
    'Li6 final'  : 139.121964, # mg/kgU
    'Li6 eff avg': 154.423, # mg/kgU
    'Li6 load'   : 544.469,  # g/cycle
    #         y3 = y1+((y2-y1)/(x2 - x1)) * (x3 - x1)
    'EOC burnup' : 1+((5-1)/(1.02137-1.04788))*(1.03-1.04788), # MWd/kgU
    'T produced' : 55.718304, # g
    'Pu produced': 1.8328208052+((8.95145732-1.8328208052)/(1.02137-1.04788))*(1.03-1.04788), # kg
    'Pu-239 frac': 98.0663245910648+((91.0432760684826-98.0663245910648)/(1.02137-1.04788))*(1.03-1.04788), # %
    }

A_SS_000 = {
    'Cladding'   : 'ss304',
    'Batches'    : None,
    'Li6 initial': 0, # mg/kgU
    'Li6 final'  : 0, # mg/kgU
    'Li6 eff avg': 0, # mg/kgU
    'Li6 load' : 0,  # g/cycle
    #         y3 = y1+((y2-y1)/(x2 - x1)) * (x3 - x1)
    'EOC burnup' : 10+((15-10)/(1.02934-1.06908))*(1.03-1.06908), # MWd/kgU
    'T produced' : 0, # g
    'Pu produced': 15.1639238+((20.868813-15.1639238)/(1.02934-1.06908))*(1.03-1.06908), # kg
    'Pu-239 frac': 83.60171264+((77.3354957946098-83.60171264)/(1.02934-1.06908))*(1.03-1.06908), # %
    }


A_SS_057 = { # updated 2024-09-15
    'Cladding'   : 'ss304',
    'Batches'    : None,
    'Li6 initial': 70, # mg/kgU
    'Li6 final'  : 45.379951, # mg/kgU
    'Li6 eff avg': 56.829414, # mg/kgU
    'Li6 load' : 200.371,  # g/cycle
    #         y3 = y1+((y2-y1)/(x2 - x1)) * (x3 - x1)
    'EOC burnup' : 5+((10-5)/(1.05567-1.01637))*(1.03-1.01637), # MWd/kgU
    'T produced' : 42.509833, # g
    'Pu produced': 8.66010214+((15.758108-8.66010214)/(1.05567-1.01637))*(1.03-1.01637), # kg
    'Pu-239 frac': 91.0393419447591+((83.6509052990371-91.0393419447591)/(1.05567-1.01637))*(1.03-1.01637), # %
    }

A_SS_079 = {
    'Cladding'   : 'ss304',
    'Batches'    : None,
    'Li6 initial': 90,        # mg/kgU
    'Li6 final'  : 69.634024, # mg/kgU
    'Li6 eff avg': 79.389493, # mg/kgU
    'Li6 load' : 279.914,  # g/cycle
    #         y3 = y1+((y2-y1)/(x2 - x1)) * (x3 - x1)
    'EOC burnup' : 5+((10-5)/(0.99818-1.03531))*(1.03-1.03531), # MWd/kgU
    'T produced' : 35.504399, # g
    'Pu produced': 8.79079152+((15.9902223-8.79079152)/(0.99818-1.03531))*(1.03-1.03531), # kg
    'Pu-239 frac': 91.0373085494354+((83.6786365377797-91.0373085494354)/(0.99818-1.03531))*(1.03-1.03531), # %
    }

# A_SS_054 = {
#     'Cladding'   : 'ss 304',
#     'Li6 load'   : 54.36, # mg/kgU
#     #         y3 = y1+((y2-y1)/(x2 - x1)) * (x3 - x1)
#     'EOC burnup' : 5+((10-5)/(1.01904-1.05783))*(1.03-1.05783), # MWd/kgU
#     'Pu produced': 7.7108+((12.8741-7.7108)/(1.01904-1.05783))*(1.03-1.05783), # kg
#     'Pu-239 frac': 90.85320779+((83.3930739383653-90.85320779)/(1.01904-1.05783))*(1.03-1.05783), # %
#     }

# A_SS_100 = {
#     'Cladding'   : 'ss 304',
#     'Li6 load'   : 100, # 54.36, # mg/kgU
#     #         y3 = y1+((y2-y1)/(x2 - x1)) * (x3 - x1)
#     'EOC burnup' : 0, #5+((10-5)/(1.01904-1.05783))*(1.03-1.05783), # MWd/kgU
#     'Pu produced': 0, # 7.7108+((12.8741-7.7108)/(1.01904-1.05783))*(1.03-1.05783), # kg
#     'Pu-239 frac': 0, # 90.85320779+((83.3930739383653-90.85320779)/(1.01904-1.05783))*(1.03-1.05783), # %
#     }